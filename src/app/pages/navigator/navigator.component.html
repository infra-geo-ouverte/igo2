<md-sidenav-container>

  <igo-backdrop
    [shown]="sidenav.opened"
    (click)="sidenav.close()">  
  </igo-backdrop>

  <button
    md-icon-button
    id="igo-menu-button"
    color="primary"
    (click)="sidenav.toggle()">
    <md-icon >
      <ng-container *ngIf="!sidenav.opened">
        menu
      </ng-container>
      <ng-container *ngIf="sidenav.opened">
        keyboard_arrow_left
      </ng-container>
    </md-icon>
  </button>

  <igo-search-bar
    [tool]="searchTool"
    (key)="sidenav.open()">  
  </igo-search-bar>

  <igo-sidenav #sidenav [opened]="false">
    <igo-flex
      #menu
      igoFlexDirection="column"
      igoFlexInitial="50%"
      igoFlexCollapsed="51px"
      igoFlexExpanded="calc(100% - 51px)"
      igoFlexState="{{initialMenuState}}">

      <div
        id="igo-upper-panel"
        class="igo-container">

        <div class="igo-content">
          <igo-toolbar
            [tools]="tools"
            *ngIf="!selectedTool">  
          </igo-toolbar>

          <igo-panel
            [title]="selectedTool.title"
            *ngIf="selectedTool">

            <md-icon
              panelLeftIcon
              (click)="goBack()">
              arrow_back
            </md-icon> 

            <md-icon
              panelRightIcon
              (click)="goHome()">
              menu
            </md-icon>

            <igo-toolbox
              [tools]="tools"
              [tool]="selectedTool"
              *ngIf="menu.state === 'initial'
                     || menu.state === 'expanded'">
            </igo-toolbox>
          </igo-panel>
        </div>

      </div>

      <div
        igoFlexFill
        id="igo-lower-panel"
        class="igo-container">

        <div class="igo-content">

          <igo-panel
            [title]="focusedResult.title"
            *ngIf="focusedResult">

            <md-icon
              panelLeftIcon
              (click)="menu.collapse()"
              *ngIf="menu.state === 'initial'">
              expand_less
            </md-icon>

            <md-icon
              panelLeftIcon
              (click)="media === 'mobile' ? menu.expand() : menu.reset()"
              *ngIf="menu.state === 'collapsed'">
              expand_more
            </md-icon>

            <md-icon
              panelLeftIcon
              (click)="media === 'mobile' ? menu.collapse() : menu.reset()"
              *ngIf="menu.state === 'expanded'">
              expand_less
            </md-icon>

            <md-icon
              panelRightIcon
              *ngIf="media !== 'mobile'">
              open_in_new
            </md-icon>

            <igo-search-result-details
              [result]="focusedResult">
            </igo-search-result-details>
          </igo-panel>
        </div>

      </div>

    </igo-flex>
  </igo-sidenav>

  <igo-map [map]="map">
  </igo-map>

</md-sidenav-container>
